import{G as e,C as t,p as s,q as i,x as a,c as o,w as n,i as c,o as l,a as r,H as h,g as d,t as w,l as g,m as u,F as p,f as k,k as m,I as f,S as D,h as S,b as v}from"./index-D5YcuF3Z.js";import{_ as P}from"./uni-nav-bar.tIzzH2Xx.js";import{_,r as C}from"./uni-app.es.BBvHst2A.js";const R=""+new URL("racesbar-C96Nm6A1.png",import.meta.url).href,M=""+new URL("ironcat-Cn3QWwzY.jpg",import.meta.url).href;const x=_({data(){return{regions:[],statuses:[],months:this.generateMonths(),distances:["全部","25.75km","51.5km","100km","113km","226km","其他距离"],selectedRegion:"",selectedStatus:"",selectedMonth:"",selectedDistance:"",races:[],isWeChat:!1,appId:"",timestamp:"",nonceStr:"",signature:"",shareTitle:"打铁123",shareDesc:"打铁从这里开始",shareLink:"https://www.datie123.com",loading:!1,isWeChatEnvironment:!1,showPickerRegion:!1,showPickerStatus:!1,showPickerMonth:!1,showPickerDistance:!1}},onPullDownRefresh(){console.log("页面级下拉刷新被触发"),this.handlePullDownRefresh()},methods:{togglePicker(e){"Region"===e&&(this.showPickerRegion=!this.showPickerRegion)},toggleDropdown(e){switch(e){case"Region":this.showPickerRegion=!this.showPickerRegion,this.showPickerStatus=!1,this.showPickerMonth=!1,this.showPickerDistance=!1;break;case"Status":this.showPickerStatus=!this.showPickerStatus,this.showPickerRegion=!1,this.showPickerMonth=!1,this.showPickerDistance=!1;break;case"Month":this.showPickerMonth=!this.showPickerMonth,this.showPickerRegion=!1,this.showPickerStatus=!1,this.showPickerDistance=!1;break;case"Distance":this.showPickerDistance=!this.showPickerDistance,this.showPickerRegion=!1,this.showPickerStatus=!1,this.showPickerMonth=!1}},hideDropdown(e){"Region"===e?this.showPickerRegion=!1:"Status"===e?this.showPickerStatus=!1:"Month"===e?this.showPickerMonth=!1:"Distance"===e&&(this.showPickerDistance=!1)},keepDropdown(e){"Region"===e?this.showPickerRegion=!0:"Status"===e?this.showPickerStatus=!0:"Month"===e?this.showPickerMonth=!0:"Distance"===e&&(this.showPickerDistance=!0)},selectOptionRegion(e){this.selectedRegion="全部"===e?"":e,this.showPickerRegion=!1,this.fetchRaceData()},selectOptionStatus(e){this.selectedStatus="全部"===e?"":e,this.showPickerStatus=!1,this.fetchRaceData()},selectOptionMonth(e){this.selectedMonth="全部"===e?"":e,this.showPickerMonth=!1,this.fetchRaceData()},selectOptionDistance(e){this.selectedDistance="全部"===e?"":e,this.showPickerDistance=!1,this.fetchRaceData()},handlePullDownRefresh(){try{this.fetchRaceData(),e(),t({title:"刷新成功",icon:"success"})}catch(s){console.error("刷新时发生错误:",s),e(),t({title:"刷新失败",icon:"none"})}finally{e()}},generateMonths(){const e=["全部"],t=new Date;for(let s=0;s<12;s++){const i=new Date(t.getFullYear(),t.getMonth()+s,1),a=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0");e.push(`${a}-${o}`)}return e},openBeianLink(){window.location.href="https://beian.miit.gov.cn/"},goHome(){this.$router.push({path:"/"})},openBeianLink(){window.location.href="https://beian.miit.gov.cn/"},fetchRaceData(){s({url:"https://www.datie123.com/entry/getRaces",method:"GET",data:{area:this.selectedRegion,race_status:this.selectedStatus,month:this.selectedMonth,rank4:this.selectedDistance},success:e=>{if(200===e.statusCode&&e.data){const{areas:t,race_statuses:s,monthes:i,ranks4:a,races:o}=e.data;this.races=o}else console.error("API request failed:",e)},fail:e=>{console.error("Failed to fetch race data:",e)}})},fetchRaceDatanit(){s({url:"https://www.datie123.com/entry/getRaces",method:"GET",data:{area:this.selectedRegion,month:this.selectedMonth,rank4:this.selectedDistance},success:e=>{if(200===e.statusCode&&e.data){const{areas:t,race_statuses:s,monthes:i,ranks4:a,races:o}=e.data;this.races=o,this.regions=["全部",...t],this.statuses=["全部",...s]}else console.error("API request failed:",e)},fail:e=>{console.error("Failed to fetch race data:",e)}})},loadWeChatSDK(){if(this.isWeChatEnvironment){const e=document.createElement("script");e.src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js",e.onload=()=>{"undefined"!=typeof wx||console.error("微信JS-SDK加载失败")},document.head.appendChild(e);const t=encodeURIComponent(window.location.href.split("#")[0]);s({url:"https://www.datie123.com/entry/getShareConfig?url="+t,method:"GET",success:e=>{200===e.statusCode&&e.data?(this.configData=e.data,this.initWeChatSDK()):console.error("获取微信JS-SDK配置失败:",e)},fail:e=>{console.error("请求微信JS-SDK配置失败:",e)}})}else console.error("当前非微信环境")},initWeChatSDK(){wx.config({debug:!1,appId:this.configData.appId,timestamp:this.configData.timestamp,nonceStr:this.configData.nonceStr,signature:this.configData.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]}),wx.ready((()=>{this.initWeChatShare()})),wx.error((e=>{console.error("微信 JS SDK 配置失败:",e)}))},initWeChatShare(){const e={title:"2025国内铁三赛事",desc:"提供最新国内铁人三项赛事信息",link:"https://www.datie123.com/#/pages/news/chinaraces",imgUrl:"https://www.datie123.com/images/share.jpg"};wx.updateAppMessageShareData({...e,success:()=>{console.log("设置给朋友分享的数据成功")},fail:e=>{console.error("设置给朋友分享的数据失败:",e)}}),wx.updateTimelineShareData({...e,success:()=>{console.log("设置朋友圈分享的数据成功")},fail:e=>{console.error("设置朋友圈分享的数据失败:",e)}})},handleShare(){const e=navigator.userAgent.toLowerCase();this.addSingleStaticsDetailShare(),this.isWeChat=/micromessenger/.test(e),this.isWeChat&&(window.location.href="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzU4NDgxNTY1MA==&scene=110#wechat_redirect")},openUrlWithPlus(e){setTimeout((()=>{"undefined"!=typeof plus&&plus.runtime?plus.runtime.openURL(e):(console.warn("plus 还未定义，回退到 window.location.href"),window.location.href=e)}),0)},openRaceLink(e){this.addSingleStaticsDetail(e)},checkWeChatEnvironment(){const e=navigator.userAgent.toLowerCase();this.isWeChatEnvironment=/micromessenger/.test(e)},async addSingleStaticsDetail(e){const t=(new Date).toLocaleString();let i={entry_id:e.entry_id,element_id:"赛事详情",click_time:t};try{const e=await s({url:"https://datie123.com/entry/addSingleStaticsDetail",method:"POST",data:{statics_detail:i}});console.log("请求结果",e)}catch(o){console.error("请求失败",o)}const a=e.link_main;console.log("当前环境是 H5"),window.location.href=a},addSingleStaticsDetailShare(){const e=(new Date).toLocaleString();s({url:"https://datie123.com/entry/addSingleStaticsDetail",method:"POST",data:{statics_detail:{element_id:"跳转ironcat",click_time:e}}}).then((e=>{console.log("EEEE",e)}))},addSingleStaticsDetailInit(){let e={page_id:"2025国内铁人三项赛事",click_time:(new Date).toLocaleString()};s({url:"https://datie123.com/entry/addSingleStaticsDetail",method:"POST",data:{statics_detail:e}}).then((e=>{console.log("EEEE",e)}))}},onReady(){this.fetchRaceDatanit(),this.checkWeChatEnvironment(),this.loadWeChatSDK(),this.addSingleStaticsDetailInit()}},[["render",function(e,t,s,i,_,x){const y=m,b=c,E=f,W=C(a("uni-nav-bar"),P),L=D,T=S;return l(),o(b,{class:"box-bg"},{default:n((()=>[r(W,{shadow:"",border:!1,fixed:""},{right:n((()=>[r(E,{class:"share-button",onClick:x.handleShare},{default:n((()=>[r(y,{class:"navi-left-image home-icon",src:M,mode:"aspectFit"})])),_:1},8,["onClick"])])),default:n((()=>[r(b,{class:"home-icon-bg"},{default:n((()=>[r(y,{class:"input-view",src:R,mode:"aspectFit"})])),_:1})])),_:1}),r(L,{class:"content-scroll","scroll-y":"","enable-pull-down-refresh":"",onRefresherrefresh:x.handlePullDownRefresh,style:{minHeight:"100px"}},{default:n((()=>[h("div",{class:"filter-row"},[r(b,{class:"filter-item"},{default:n((()=>[r(b,{onClick:t[0]||(t[0]=e=>x.toggleDropdown("Region")),class:"picker-text"},{default:n((()=>[d(w(_.selectedRegion||"主办方"),1)])),_:1}),_.showPickerRegion?(l(),o(b,{key:0,class:"dropdown",onMouseover:t[1]||(t[1]=e=>x.keepDropdown("Region")),onMouseleave:t[2]||(t[2]=e=>x.hideDropdown("Region"))},{default:n((()=>[(l(!0),g(p,null,u(_.regions,((e,t)=>(l(),o(b,{key:t,onClick:t=>x.selectOptionRegion(e),class:"dropdown-item",style:v({color:e===_.selectedRegion?"blue":""})},{default:n((()=>[d(w(e),1)])),_:2},1032,["onClick","style"])))),128))])),_:1})):k("",!0)])),_:1}),r(b,{class:"filter-item2"},{default:n((()=>[r(b,{onClick:t[3]||(t[3]=e=>x.toggleDropdown("Status")),class:"picker-text"},{default:n((()=>[d(w(_.selectedStatus||"赛事状态"),1)])),_:1}),_.showPickerStatus?(l(),o(b,{key:0,class:"dropdown",onMouseover:t[4]||(t[4]=e=>x.keepDropdown("Status")),onMouseleave:t[5]||(t[5]=e=>x.hideDropdown("Status"))},{default:n((()=>[(l(!0),g(p,null,u(_.statuses,((e,t)=>(l(),o(b,{key:t,onClick:t=>x.selectOptionStatus(e),class:"dropdown-item",style:v({color:e===_.selectedStatus?"blue":""})},{default:n((()=>[d(w(e),1)])),_:2},1032,["onClick","style"])))),128))])),_:1})):k("",!0)])),_:1}),r(b,{class:"filter-item3"},{default:n((()=>[r(b,{onClick:t[6]||(t[6]=e=>x.toggleDropdown("Month")),class:"picker-text"},{default:n((()=>[d(w(_.selectedMonth||"赛事月份"),1)])),_:1}),_.showPickerMonth?(l(),o(b,{key:0,class:"dropdown",onMouseover:t[7]||(t[7]=e=>x.keepDropdown("Month")),onMouseleave:t[8]||(t[8]=e=>x.hideDropdown("Month"))},{default:n((()=>[(l(!0),g(p,null,u(_.months,((e,t)=>(l(),o(b,{key:t,onClick:t=>x.selectOptionMonth(e),class:"dropdown-item",style:v({color:e===_.selectedMonth?"blue":""})},{default:n((()=>[d(w(e),1)])),_:2},1032,["onClick","style"])))),128))])),_:1})):k("",!0)])),_:1}),r(b,{class:"filter-item4"},{default:n((()=>[r(b,{onClick:t[9]||(t[9]=e=>x.toggleDropdown("Distance")),class:"picker-text"},{default:n((()=>[d(w(_.selectedDistance||"赛事距离"),1)])),_:1}),_.showPickerDistance?(l(),o(b,{key:0,class:"dropdown",onMouseover:t[10]||(t[10]=e=>x.keepDropdown("Distance")),onMouseleave:t[11]||(t[11]=e=>x.hideDropdown("Distance"))},{default:n((()=>[(l(!0),g(p,null,u(_.distances,((e,t)=>(l(),o(b,{key:t,onClick:t=>x.selectOptionDistance(e),class:"dropdown-item",style:v({color:e===_.selectedDistance?"blue":""})},{default:n((()=>[d(w(e),1)])),_:2},1032,["onClick","style"])))),128))])),_:1})):k("",!0)])),_:1})]),h("div",{class:"races-container"},[(l(!0),g(p,null,u(_.races,((e,t)=>(l(),g("div",{key:t,class:"race-item",style:v({backgroundImage:`url(${e.bk_image})`,backgroundSize:"cover",backgroundPosition:"center"})},[h("div",{class:"overlay"}),h("div",{class:"content"},[h("div",{class:"title"},w(e.title),1),h("div",{class:"title-container"},[h("div",{class:"title-container-left"},[h("div",{class:"title-container-left-detail"},[h("img",{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1737426430308'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1368'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M509.742106%2034.86188c-96.818487%200-189.482448%2038.47451-257.761157%20106.933851-68.278709%2068.45934-106.753219%20161.303934-106.753219%20257.941789%200%20145.408361%20189.482448%20434.960663%20295.151878%20559.777033%2017.159993%2020.41136%2042.448404%2032.152408%2069.181867%2032.152408h0.361263c26.733463%200%2052.021873-11.741048%2069.181866-32.152408C684.774034%20834.698183%20874.256483%20544.96525%20874.256483%20399.73752c0.180632-201.404128-163.110249-364.875639-364.514377-364.87564z%20m8.128418%20872.992062c-1.986947%202.34821-4.877051%203.61263-7.947786%203.612631h-0.361263c-3.070736%200-5.96084-1.445052-7.947787-3.793262-42.990298-50.757453-115.2429-149.201623-178.825189-260.109367-87.967543-154.078673-97.360381-224.705592-97.360381-247.826424%200-157.149409%20127.345211-284.49462%20284.313988-284.675252%20157.149409%200.361263%20284.313988%20127.706474%20284.313989%20284.675252%200%2069.543129-68.098077%20196.527077-97.360381%20247.826424-63.221027%20110.907744-135.834892%20209.171282-178.82519%20260.289998z'%20fill='white'%20p-id='1369'%3e%3c/path%3e%3cpath%20d='M509.922738%20217.2997h-0.361263c-88.509437%200-160.400776%2071.891339-160.400776%20160.400776s71.891339%20160.400776%20160.400776%20160.400776h0.722526c88.509437-0.180632%20160.220145-72.07197%20160.220144-160.581407-0.180632-88.690069-72.07197-160.400776-160.581407-160.220145z%20m0%20240.601164h-0.541895c-44.254719%200-80.200388-35.945669-80.200388-80.200388s35.945669-80.200388%2080.200388-80.200388h0.180632c44.254719%200%2080.200388%2035.765038%2080.381019%2080.019757%200.180632%2044.254719-35.584406%2080.200388-80.019756%2080.381019z'%20fill='white'%20p-id='1370'%3e%3c/path%3e%3c/svg%3e",alt:"位置图标",class:"location-icon",draggable:"false"}),h("div",{class:"title2"},w(e.area),1)]),h("div",{class:"title-container-left-detail"},[h("img",{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1737426443022'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1688'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M170.666667%20640V362.666667a192%20192%200%200%201%20384%200v298.666666a106.666667%20106.666667%200%200%200%20213.333333%200V376.746667a128.042667%20128.042667%200%201%201%2085.333333%200v284.586666a192%20192%200%201%201-384%200v-298.666666a106.666667%20106.666667%200%200%200-213.333333%200V640h128l-170.666667%20213.333333-170.666666-213.333333h128z'%20fill='white'%20p-id='1689'%3e%3c/path%3e%3c/svg%3e",alt:"位置图标",class:"location-icon",draggable:"false"}),h("div",{class:"title2"},w(e.race_distance),1)])]),h("div",{class:"title-container-right"},[e.icon?(l(),g("div",{key:0,class:"img-icon"},[h("img",{src:e.icon,alt:"icon",class:"race-icon",draggable:"false"},null,8,["src"])])):k("",!0)])]),h("div",{class:"race-details"},[h("div",{class:"race-details-left"},[h("div",{class:"bottom-row-text"},w(e.race_date?e.race_date:"敬请期待"),1),h("div",{class:"bottom-row-text2"},w(e.race_status),1),null!==e.race_level&&""!==e.race_level?(l(),g("div",{key:0,class:"bottom-row-text3"},w(e.race_level),1)):k("",!0)]),null!==e.link_main&&""!==e.link_main?(l(),g("div",{key:0,class:"race-details-right"},[h("div",{class:"bottom-row-text4",onClick:t=>x.openRaceLink(e)}," 查看详情 ",8,["onClick"])])):k("",!0)])])],4)))),128))])])),_:1},8,["onRefresherrefresh"]),r(b,{class:"beian-container"},{default:n((()=>[r(T,{class:"beian-text",onClick:x.openBeianLink},{default:n((()=>[d("苏ICP备2022016640号-3")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-97446e2b"]]);export{x as default};
